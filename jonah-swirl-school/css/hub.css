@import url("./tokens.css");

/* Shadows/veils tuned to poster look */
:root{
  --hub-shadow-rgb: 27,31,51;
  --hub-veil: color-mix(in srgb, var(--surface) 92%, transparent);
  --hub-ring: color-mix(in srgb, var(--cup-mint) 26%, transparent);
  --hub-cocoa: color-mix(in oklab, var(--ink-900) 72%, var(--cup-orange) 28%);
  --hub-cocoa-soft: color-mix(in oklab, var(--hub-cocoa) 88%, white 12%);
  --hub-cocoa-mist: color-mix(in oklab, var(--hub-cocoa) 64%, white 36%);
  --hub-cocoa-faint: color-mix(in oklab, var(--hub-cocoa) 44%, white 56%);
}

*{box-sizing:border-box}
html,body{height:100%}

/* Background wash (art pastels, not baby) */
body{
  --ink: var(--hub-cocoa);
  --ink-soft: var(--hub-cocoa-soft);
  --ink-mist: var(--hub-cocoa-mist);
  --ink-faint: var(--hub-cocoa-faint);
  --hub-veil: color-mix(in srgb, var(--surface-strong) 94%, transparent);
  background:
    radial-gradient(1280px 880px at 14% -12%, color-mix(in srgb, var(--glow-apricot) 78%, transparent) 0 46%, transparent 78%),
    radial-gradient(1260px 860px at 86% -6%, color-mix(in srgb, var(--glow-rose) 74%, transparent) 0 48%, transparent 82%),
    radial-gradient(1340px 980px at 50% 118%, color-mix(in srgb, var(--glow-mint) 54%, transparent) 0 48%, transparent 86%),
    linear-gradient(180deg,
      color-mix(in srgb, var(--glow-apricot) 46%, var(--paper) 54%) 0%,
      color-mix(in srgb, var(--glow-rose) 42%, var(--paper) 58%) 52%,
      color-mix(in srgb, var(--glow-sky) 28%, var(--paper) 72%) 100%
    );
  background-attachment: fixed;
  color:var(--hub-cocoa);
  font:16px/1.45 ui-sans-serif, system-ui, -apple-system, Segoe UI, Inter, Roboto, Arial, sans-serif;
}

/* Toolbar */
.lab-toolbar{
  position:fixed; top:clamp(12px,3vw,26px); left:50%; transform:translateX(-50%);
  width:min(760px, calc(100% - clamp(32px,10vw,88px)));
  display:flex; align-items:center; gap:clamp(10px,3vw,20px); flex-wrap:wrap;
  padding:10px clamp(14px,3vw,20px);
  background: color-mix(in srgb, var(--hub-veil) 96%, transparent);
  backdrop-filter: blur(16px);
  border-radius:18px; border:1px solid color-mix(in srgb, var(--hub-cocoa) 12%, transparent);
  box-shadow: 0 20px 44px -30px rgba(var(--hub-shadow-rgb),0.22);
  z-index:12;
}
.brand{
  display:flex; align-items:center; gap:10px; font-weight:600;
  color:color-mix(in srgb, var(--hub-cocoa-soft) 94%, transparent);
}
.swirl-dot{
  width:16px; height:16px; border-radius:50%;
  background:conic-gradient(from 0deg, var(--glow-sky), var(--glow-apricot), var(--glow-rose), var(--cup-mint), var(--glow-sky));
  box-shadow:0 0 0 1px color-mix(in srgb, var(--hub-cocoa) 24%, transparent) inset;
}
.pill{ appearance:none; border:1px solid transparent; border-radius:999px; padding:8px 16px; background:color-mix(in srgb, var(--surface) 94%, transparent); box-shadow:0 6px 18px -14px rgba(var(--hub-shadow-rgb),0.3); cursor:pointer; color:var(--ink); font-size:.95rem; }
#crumbBox{
  flex:1 1 clamp(240px,44vw,420px);
  min-width:clamp(220px,42vw,320px);
  background:color-mix(in srgb, var(--surface-strong) 96%, transparent);
  border:1.5px solid color-mix(in srgb, var(--hub-cocoa) 18%, transparent);
  color:var(--hub-cocoa);
  transition: border-color .2s ease, box-shadow .2s ease;
}
#crumbBox::placeholder{ color:var(--hub-cocoa-mist); }
#crumbBox:focus-visible{
  outline:none;
  border-color:color-mix(in srgb, var(--cup-mint) 42%, transparent);
  box-shadow:0 0 0 4px color-mix(in srgb, var(--cup-mint) 24%, transparent);
}
#crumbBox.quick-saved{
  border-color:color-mix(in srgb, var(--cup-mint) 54%, transparent);
  box-shadow:0 0 0 6px color-mix(in srgb, var(--cup-mint) 26%, transparent);
}

.view-toggle{
  display:flex;
  align-items:center;
  gap:10px;
  padding:4px 12px;
  border-radius:999px;
  background: color-mix(in srgb, var(--surface-strong) 88%, transparent);
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--hub-cocoa-faint) 40%, transparent);
}
.view-toggle__legend{
  font-size:.7rem;
  letter-spacing:.16em;
  text-transform:uppercase;
  color:var(--hub-cocoa-mist);
}

.mode-switch{
  position:relative;
  display:inline-flex;
  align-items:center;
  gap:10px;
  border:0;
  padding:0;
  background:none;
  cursor:pointer;
  border-radius:999px;
  font:inherit;
  color:inherit;
}
.mode-switch:focus-visible{
  outline:2px solid color-mix(in srgb, var(--cup-mint) 62%, transparent);
  outline-offset:4px;
}
.mode-switch__label{
  font-size:.82rem;
  font-weight:600;
  color:var(--hub-cocoa-mist);
  transition:color .25s ease;
}
.mode-switch__label--swirl{ color:var(--hub-cocoa-soft); }
.mode-switch[aria-checked="false"] .mode-switch__label--swirl{ color:var(--hub-cocoa-mist); }
.mode-switch[aria-checked="false"] .mode-switch__label--structure{ color:var(--hub-cocoa-soft); }

.mode-switch__track{
  position:relative;
  display:inline-flex;
  align-items:center;
  width:68px;
  height:30px;
  padding:4px;
  border-radius:999px;
  background:linear-gradient(120deg, color-mix(in srgb, var(--cup-mint) 28%, var(--surface) 72%), color-mix(in srgb, var(--glow-rose) 24%, var(--surface) 76%));
  box-shadow: inset 0 3px 8px rgba(var(--hub-shadow-rgb),0.18);
  transition:background .3s ease;
}
.mode-switch[aria-checked="false"] .mode-switch__track{
  background:linear-gradient(120deg, color-mix(in srgb, var(--glow-rose) 36%, var(--surface) 64%), color-mix(in srgb, var(--glow-sky) 26%, var(--surface) 74%));
}
.mode-switch__track::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  box-shadow:inset 0 1px 0 color-mix(in srgb, #fff 45%, transparent);
  pointer-events:none;
}
.mode-switch__thumb{
  width:22px;
  height:22px;
  border-radius:50%;
  background:color-mix(in srgb, var(--surface) 94%, transparent);
  box-shadow:0 10px 20px -14px rgba(var(--hub-shadow-rgb),0.65), inset 0 1px 0 color-mix(in srgb, #fff 65%, transparent);
  transform:translateX(0);
  transition:transform .28s ease;
}
.mode-switch[aria-checked="false"] .mode-switch__thumb{ transform:translateX(36px); }

/* Pond + hero */
#pond{
  position:relative;
  min-height:100dvh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:clamp(48px, 9vh, 96px);
  padding: clamp(160px, 22vh, 220px) clamp(24px, 6vw, 56px) clamp(150px, 26vh, 240px);
  overflow:hidden;
}

.sparkles{
  position:absolute;
  inset:-18%;
  background:
    radial-gradient(220px 220px at 18% 24%, color-mix(in srgb, var(--glow-rose) 42%, transparent) 0 38%, transparent 68%),
    radial-gradient(260px 260px at 82% 26%, color-mix(in srgb, var(--glow-apricot) 36%, transparent) 0 34%, transparent 70%),
    radial-gradient(200px 200px at 50% 74%, color-mix(in srgb, var(--glow-sky) 44%, transparent) 0 32%, transparent 72%);
  mix-blend-mode: screen;
  pointer-events:none;
  opacity:.45;
  animation:sparkle-glow 18s ease-in-out infinite alternate;
}

@keyframes sparkle-glow{
  0%{ transform:scale(.98) rotate(-1deg); opacity:.36; }
  50%{ transform:scale(1.02) rotate(1deg); opacity:.58; }
  100%{ transform:scale(1) rotate(-1deg); opacity:.4; }
}

.site-banner{
  position:relative;
  text-align:center;
  width:min(480px, 100%);
  padding:1rem 1.8rem 1.2rem;
  border-radius:22px;
  background: linear-gradient(175deg, color-mix(in srgb, var(--surface-strong) 96%, transparent) 0%, color-mix(in srgb, var(--glow-apricot) 24%, var(--surface-strong)) 100%);
  border:1px solid color-mix(in srgb, var(--hub-cocoa) 18%, transparent);
  backdrop-filter: blur(14px);
  z-index:9;
  box-shadow: 0 22px 52px -32px rgba(var(--hub-shadow-rgb),0.28), inset 0 1px 0 color-mix(in srgb, #fff 42%, transparent);
}
.site-banner h1{
  margin:0; font-size:2.35rem; font-weight:700; letter-spacing:.02em;
  color:var(--hub-cocoa);
}
.site-banner .site-subtitle{
  margin:10px 0 0; font-size:1.08rem; letter-spacing:.08em;
  color:var(--hub-cocoa-mist);
}

/* Ripples */
#pond::before{
  content:""; position:absolute; inset:-20%;
  background:
    radial-gradient(circle at 50% 42%, color-mix(in srgb, var(--glow-apricot) 46%, transparent) 0 36%, transparent 62%),
    radial-gradient(circle at 52% 64%, color-mix(in srgb, var(--glow-sky) 42%, transparent) 0 24%, transparent 68%),
    repeating-radial-gradient(circle at 50% 50%, color-mix(in srgb, var(--hub-cocoa-faint) 48%, transparent) 0 2px, transparent 2px 14px);
  mix-blend-mode: soft-light;
  opacity:.52;
  animation: ripple 24s ease-in-out infinite;
  pointer-events:none;
}
@keyframes ripple{ 0%,100%{transform:scale(.98);opacity:.48} 50%{transform:scale(1.04);opacity:.82} }

/* Swirl dish + your sprout SVG/PNG */
.hub-core{
  position:relative;
  width:min(520px, 84vw);
  aspect-ratio:1/1;
  display:grid;
  place-items:center;
  z-index:7;
}

.swirl{
  --swirl-stroke: color-mix(in srgb, var(--hub-cocoa) 94%, transparent);
  --swirl-width: 11;
  position:relative;
  width: clamp(220px, 58%, 360px);
  aspect-ratio:1/1;
  border-radius:50%;
  display:grid;
  place-items:center;
  padding: clamp(22px, 4vw, 44px);
  background:
    radial-gradient(64% 60% at 50% 36%, color-mix(in srgb, var(--surface-strong) 96%, transparent) 0 58%, transparent 86%),
    radial-gradient(88% 80% at 50% 74%, color-mix(in srgb, var(--glow-apricot) 52%, transparent) 0 74%, transparent 94%);
  border:1.5px solid color-mix(in srgb, var(--hub-cocoa) 22%, transparent);
  box-shadow: inset 0 0 34px color-mix(in srgb, var(--glow-apricot) 42%, transparent), 0 34px 72px -42px rgba(var(--hub-shadow-rgb),0.35);
  animation: breathe 7s ease-in-out infinite; z-index:7; isolation:isolate;
}
.swirl::before{
  content:""; position:absolute; inset:-42px; border-radius:50%;
  background:
    radial-gradient(78% 72% at 48% 32%, color-mix(in srgb, var(--glow-rose) 62%, transparent) 0 56%, transparent 86%),
    radial-gradient(84% 78% at 54% 70%, color-mix(in srgb, var(--glow-sky) 58%, transparent) 0 58%, transparent 88%);
  opacity:.88; filter:blur(34px); z-index:-1;
}
.swirl::after{
  content:""; position:absolute; inset:12%; border-radius:50%;
  background:repeating-radial-gradient(circle at 50% 50%, color-mix(in srgb, var(--hub-cocoa-faint) 52%, transparent) 0 2px, transparent 2px 12px);
  opacity:.18; mix-blend-mode:soft-light; pointer-events:none;
}
@keyframes breathe{ 0%,100%{transform:scale(1)} 50%{transform:scale(1.03)} }
.swirl-svg{ width:min(80%, 332px); height:auto; filter: drop-shadow(0 12px 26px rgba(var(--hub-shadow-rgb),0.2)); z-index:1; }

.enter-day{
  position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
  display:block;
  width:clamp(100px,15vw,148px); height:clamp(100px,15vw,148px);
  border-radius:50%; border:0; background:radial-gradient(circle at 50% 50%, color-mix(in srgb, var(--cup-mint) 22%, transparent) 0 58%, transparent 82%);
  z-index:8;
  transition: box-shadow .25s ease, transform .25s ease;
}
.enter-day:hover{
  box-shadow:0 0 0 14px color-mix(in srgb, var(--cup-mint) 18%, transparent);
}
.enter-day:focus-visible{
  outline:2px solid color-mix(in srgb, var(--cup-mint) 58%, transparent);
  outline-offset:6px;
}

/* Tokens (orbit + glow pulses) */
.token{
  --size: clamp(78px, 11vw, 102px);
  --token-color: var(--token-self);
  --token-highlight: var(--cup-rose);
  --orbit-duration: 36s;
  --pulse-duration: 7.5s;
  --pulse-delay: 0s;
  --initial-angle: 0deg;
  --initial-radius: clamp(92px, 28vw, 168px);
  --active-angle: var(--angle, var(--initial-angle));
  --active-radius: var(--radius, var(--initial-radius));
  position:absolute;
  top:50%;
  left:50%;
  width:var(--size);
  height:var(--size);
  border-radius:50%;
  border:1px solid color-mix(in srgb, var(--token-color) 28%, transparent);
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:0 12px;
  color:color-mix(in srgb, var(--hub-cocoa) 92%, transparent);
  font-weight:600;
  font-size:.9rem;
  letter-spacing:.2px;
  text-shadow:0 1px 0 color-mix(in srgb, #fff 42%, transparent);
  background:
    radial-gradient(circle at 34% 28%, color-mix(in srgb, var(--surface-strong) 90%, transparent) 0 46%, transparent 72%),
    linear-gradient(150deg, color-mix(in srgb, var(--token-color) 90%, transparent) 0%, color-mix(in srgb, var(--token-highlight) 58%, var(--token-color) 42%) 100%);
  box-shadow:0 18px 42px -28px rgba(var(--hub-shadow-rgb),0.34);
  transition: transform .25s ease, box-shadow .25s ease, background .3s ease, filter .3s ease;
  transform: translate(-50%, -50%) rotate(var(--active-angle)) translateX(var(--active-radius)) rotate(calc(var(--active-angle) * -1));
  animation: drift var(--orbit-duration) linear infinite;
  z-index:8;
  isolation:isolate;
}
.token::after{
  content:""; position:absolute; inset:-16px; border-radius:inherit;
  background:radial-gradient(circle at 50% 50%, color-mix(in srgb, var(--token-color) 76%, transparent) 0 52%, transparent 78%);
  opacity:0; filter: blur(.6px); transform:scale(.84); pointer-events:none; z-index:-1;
  animation: token-glow var(--pulse-duration) ease-in-out infinite; animation-delay: var(--pulse-delay);
}
@keyframes drift{
  from{
    transform: translate(-50%, -50%) rotate(var(--active-angle)) translateX(var(--active-radius)) rotate(calc(var(--active-angle) * -1));
  }
  to{
    transform: translate(-50%, -50%) rotate(calc(var(--active-angle) + 360deg)) translateX(var(--active-radius)) rotate(calc((var(--active-angle) + 360deg) * -1));
  }
}
@keyframes token-glow{
  0%,100%{ opacity:0; transform:scale(.76); filter:blur(.6px); }
  36%    { opacity:.62; transform:scale(1.18); filter:blur(7px); }
  58%    { opacity:.24; transform:scale(1.02); filter:blur(3px); }
}
.token:hover{
  filter: brightness(1.05);
  box-shadow:0 20px 44px -26px rgba(var(--hub-shadow-rgb),0.36);
}
.token:focus-visible{
  outline:2px solid color-mix(in srgb, var(--cup-mint) 58%, transparent);
  outline-offset:6px;
}
.token[data-pillar="divine"]{ --token-color: var(--token-divine); --token-highlight: var(--cup-lilac); }
.token[data-pillar="family"]{ --token-color: var(--token-family); --token-highlight: var(--cup-orange); }
.token[data-pillar="self"]  { --token-color: var(--token-self);   --token-highlight: var(--cup-mint); }
.token[data-pillar="rrr"]   { --token-color: var(--token-rrr);    --token-highlight: var(--cup-sky); }
.token[data-pillar="work"]  { --token-color: var(--token-work);   --token-highlight: var(--cup-apricot); }

.hub-core .token:nth-of-type(1){ --initial-angle: -90deg; }
.hub-core .token:nth-of-type(2){ --initial-angle: -18deg; }
.hub-core .token:nth-of-type(3){ --initial-angle: 54deg; }
.hub-core .token:nth-of-type(4){ --initial-angle: 126deg; }
.hub-core .token:nth-of-type(5){ --initial-angle: 198deg; }

/* Structured mode = calm ring */
body.mode-structured .token{
  animation: none;
  transform: translate(-50%, -50%) rotate(var(--active-angle)) translateX(var(--active-radius)) rotate(calc(var(--active-angle) * -1));
  transition: transform .45s ease;
}
