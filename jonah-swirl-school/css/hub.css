/* ================================
   Swirlface Dev Lab — Styles
   Palette = art-pastels (not baby)
   ================================ */

/* ~lines 6-38: base + palette */
:root{
  --hub-shadow-rgb: 27,31,51;
  --hub-glow: 0 8px 22px rgba(var(--hub-shadow-rgb),0.12), 0 0 0 1px rgba(var(--hub-shadow-rgb),0.04);
  --hub-glow-strong: 0 20px 44px rgba(var(--hub-shadow-rgb),0.16), 0 0 0 1px rgba(var(--hub-shadow-rgb),0.06);
  --hub-veil: color-mix(in srgb, var(--surface) 82%, transparent);
  --hub-ring: color-mix(in srgb, var(--accent1) 22%, transparent);
  --hub-bg-peach: color-mix(in srgb, var(--pastel-peach) 70%, transparent);
  --hub-bg-sky: color-mix(in srgb, var(--pastel-sky) 68%, transparent);
  --hub-bg-pink: color-mix(in srgb, var(--pastel-pink) 62%, transparent);
  --hub-bg-mint: color-mix(in srgb, var(--accent1) 64%, transparent);
}

* { box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  color:var(--ink);
  font: 16px/1.45 ui-sans-serif, system-ui, -apple-system, Segoe UI, Inter, Roboto, Arial, sans-serif;
  background:
    radial-gradient(1200px 840px at 18% -10%, color-mix(in srgb, var(--hub-bg-peach) 82%, var(--surface) 18%) 0 68%, transparent 76%),
    radial-gradient(1100px 920px at 85% 6%, color-mix(in srgb, var(--hub-bg-sky) 78%, var(--surface) 22%) 0 72%, transparent 78%),
    radial-gradient(1080px 940px at 14% 88%, color-mix(in srgb, var(--hub-bg-pink) 80%, transparent) 0 70%, transparent 82%),
    radial-gradient(960px 880px at 86% 92%, color-mix(in srgb, var(--hub-bg-mint) 82%, var(--surface) 18%) 0 66%, transparent 82%),
    var(--paper);
  background-attachment: fixed;
}

/* ~lines 40-78: toolbar */
.lab-toolbar{
  position:fixed;
  top:clamp(12px, 3vw, 24px);
  left:50%;
  transform:translateX(-50%);
  width:min(680px, calc(100% - clamp(28px, 8vw, 72px)));
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:clamp(8px, 2.6vw, 14px);
  padding:8px 14px;
  background:color-mix(in srgb, var(--hub-veil) 88%, transparent);
  backdrop-filter: blur(12px);
  border-radius:14px;
  box-shadow: var(--hub-glow);
  border:1px solid var(--hub-ring);
  z-index:12;
  flex-wrap:wrap;
}
.brand{
  display:flex;
  align-items:center;
  gap:8px;
  font-size:0.95rem;
  letter-spacing:0.4px;
}
.swirl-dot{
  width:16px; height:16px; border-radius:50%;
  background:conic-gradient(from 0deg,
    var(--pastel-sky),
    var(--pastel-peach),
    var(--pastel-pink),
    var(--accent1),
    var(--pastel-sky)
  );
  box-shadow: 0 0 0 1px color-mix(in srgb, var(--accent1) 30%, transparent) inset;
}
.pill{
  appearance:none;
  border:0;
  border-radius:999px;
  padding:7px 16px;
  background:color-mix(in srgb, var(--surface) 90%, transparent);
  box-shadow: var(--hub-glow);
  cursor:pointer;
  color:var(--ink);
  font-size:0.95rem;
}
.pill.active{
  background:color-mix(in srgb, var(--surface-strong) 94%, transparent);
  box-shadow: var(--hub-glow-strong);
}
.modes{
  display:flex;
  gap:8px;
  flex:0 0 auto;
}
#crumbBox{
  flex:1 1 clamp(200px, 42vw, 320px);
  min-width:clamp(180px, 38vw, 280px);
  background:color-mix(in srgb, var(--surface-strong) 96%, transparent);
  border:1px solid color-mix(in srgb, var(--accent1) 22%, transparent);
  cursor:text;
}
#crumbBox::placeholder{
  color:color-mix(in srgb, var(--ink) 58%, transparent);
}

@media (max-width: 640px){
  .lab-toolbar{
    width:min(92vw, 540px);
    gap:10px;
  }
  .modes{
    width:100%;
    justify-content:center;
  }
  #crumbBox{
    flex-basis:100%;
    min-width:100%;
  }
  #pond{
    padding-top: clamp(210px, 50vh, 320px);
    padding-bottom: clamp(200px, 46vh, 300px);
  }
  .site-banner{
    top:clamp(140px, 34vh, 220px);
    width:min(420px, calc(100vw - 48px));
    padding:0.45rem 1.25rem 0.75rem;
  }
}

@media (max-width: 420px){
  .lab-toolbar{
    padding:8px 10px;
  }
}

/* ~lines 80-144: pond + swirl + ripples */
#pond{
  position:relative;
  min-height:100dvh;
  width:100%;
  overflow:hidden;
  display:grid;
  place-items:center;
  padding: clamp(180px, 34vh, 260px) clamp(20px, 6vw, 48px) clamp(180px, 40vh, 280px);
}

.site-banner{
  position:absolute;
  top:clamp(112px, 22vh, 188px);
  left:50%; transform:translateX(-50%);
  text-align:center;
  width:min(460px, calc(100vw - 96px));
  padding:0.5rem 1.5rem 0.9rem;
  border-radius:18px;
  background:color-mix(in srgb, var(--surface) 82%, transparent);
  box-shadow:0 12px 32px -20px color-mix(in srgb, var(--accent1) 35%, transparent);
  backdrop-filter: blur(12px);
  z-index:9; pointer-events:none;
}
.site-banner h1{
  margin:0; font-size:2.1rem; font-weight:700;
  background:linear-gradient(90deg,
    color-mix(in srgb, var(--accent2) 70%, var(--pastel-pink) 30%),
    color-mix(in srgb, var(--pastel-peach) 60%, var(--accent3) 40%),
    color-mix(in srgb, var(--pastel-sky) 60%, var(--accent1) 40%)
  );
  -webkit-background-clip:text; color:transparent;
}
.site-banner p{
  margin:6px 0 0; font-size:1.1rem; letter-spacing:0.5px;
  color:color-mix(in srgb, var(--ink) 78%, transparent);
}

/* soft rippling field (a hair stronger so rings read) */
#pond::before{
  content:"";
  position:absolute;
  inset:-22%;
  background:
    radial-gradient(circle at 50% 42%, color-mix(in srgb, var(--pastel-peach) 28%, transparent) 0 34%, transparent 72%),
    radial-gradient(circle at 52% 60%, color-mix(in srgb, var(--accent1) 26%, transparent) 0 20%, transparent 46%),
    radial-gradient(circle at 48% 38%, color-mix(in srgb, var(--pastel-pink) 24%, transparent) 0 18%, transparent 56%),
    repeating-radial-gradient(circle at 50% 50%,
      color-mix(in srgb, var(--surface) 78%, transparent) 0 2px,
      transparent 2px 14px);
  mix-blend-mode: soft-light;
  animation: ripple 22s ease-in-out infinite;
  pointer-events:none;
}
@keyframes ripple{
  0%,100%{ transform: scale(1); opacity:0.6; }
  50%    { transform: scale(1.05); opacity:0.82; }
}

.swirl{
  position:relative;
  width: clamp(230px, 34vw, 360px);
  aspect-ratio: 1/1;
  border-radius:50%;
  display:grid;
  place-items:center;
  padding: clamp(18px, 3.4vw, 32px);
  background:
    radial-gradient(64% 58% at 50% 40%, color-mix(in srgb, var(--surface-strong) 95%, transparent) 0 52%, transparent 78%),
    radial-gradient(86% 82% at 50% 32%, color-mix(in srgb, var(--accent1) 24%, transparent) 0 70%, transparent 86%);
  box-shadow:
    0 28px 60px -34px color-mix(in srgb, var(--accent1) 42%, transparent),
    var(--hub-glow-strong);
  animation: breathe 6.5s ease-in-out infinite;
  z-index:7;
  isolation:isolate;
}
.swirl::before{
  content:"";
  position:absolute;
  inset:-34px;
  border-radius:50%;
  background:
    radial-gradient(78% 74% at 50% 54%, color-mix(in srgb, var(--pastel-peach) 42%, transparent) 0 56%, transparent 92%),
    radial-gradient(72% 68% at 52% 32%, color-mix(in srgb, var(--pastel-pink) 46%, transparent) 0 48%, transparent 84%),
    radial-gradient(86% 82% at 50% 70%, color-mix(in srgb, var(--accent1) 40%, transparent) 0 34%, transparent 84%);
  opacity:0.85;
  filter: blur(8px);
  z-index:-2;
}
@keyframes breathe{ 0%,100%{ transform:scale(1)} 50%{ transform:scale(1.03)} }
.swirl-svg{
  width:82%;
  height:82%;
  position:relative;
  object-fit:contain;
  display:block;
  z-index:1;
}
.enter-day{
  position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
  width:clamp(96px, 14vw, 128px);
  height:clamp(118px, 18vw, 156px);
  border-radius:64px;
  background: radial-gradient(64% 58% at 50% 32%, color-mix(in srgb, var(--accent1) 38%, transparent) 0 58%, transparent 84%);
  box-shadow:
    0 0 0 1px color-mix(in srgb, var(--accent1) 36%, transparent),
    0 22px 46px -30px color-mix(in srgb, var(--accent1) 60%, transparent);
  border:0;
  display:block;
  z-index:6;
  pointer-events:auto;
  transition: box-shadow .25s ease, transform .3s ease;
}
.enter-day::before{
  content:"";
  position:absolute;
  inset:-28px;
  border-radius:inherit;
  background:
    radial-gradient(62% 60% at 50% 32%, color-mix(in srgb, var(--pastel-pink) 36%, transparent) 0 56%, transparent 84%),
    radial-gradient(62% 64% at 50% 64%, color-mix(in srgb, var(--accent1) 30%, transparent) 0 48%, transparent 86%);
  opacity:0.85;
  filter: blur(18px);
  z-index:-1;
}
.enter-day::after{
  content:"";
  position:absolute;
  inset:22% 26% 26%;
  border-radius:50%;
  background: color-mix(in srgb, var(--surface) 92%, transparent);
  opacity:0.75;
}
.enter-day:hover,
.enter-day:focus-visible{
  box-shadow:
    0 0 0 3px color-mix(in srgb, var(--accent1) 42%, transparent),
    0 26px 44px -26px color-mix(in srgb, var(--pastel-pink) 44%, transparent);
  transform:translate(-50%,-50%) scale(1.03);
}
.enter-day:focus-visible{
  outline:3px solid color-mix(in srgb, var(--accent1) 62%, transparent);
  outline-offset:8px;
}

/* ~lines 146-220: tokens (circles → doors) */
.intro-card{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:0.6rem;
  padding:1rem 1.35rem 1.05rem;
  text-align:center;
  line-height:1.4;
}
.intro-card p{
  margin:0;
  font-size:1rem;
  letter-spacing:0.12px;
}

.token{
  --size: 88px;
  --token-color: var(--token-self);
  position:absolute; inset:auto;
  width:var(--size); height:var(--size); border-radius:50%;
  border:none; cursor:pointer;
  display:flex; align-items:center; justify-content:center;
  text-align:center; padding:0 8px;
  color:color-mix(in srgb, var(--ink) 88%, transparent);
  font-weight:600; letter-spacing:0.2px;
  background:
    radial-gradient(circle at 35% 28%, color-mix(in srgb, var(--surface-strong) 85%, transparent) 0 45%, transparent 70%),
    linear-gradient(145deg,
      color-mix(in srgb, var(--token-color) 88%, var(--surface) 12%),
      color-mix(in srgb, var(--token-color) 82%, var(--ink) 18%));
  box-shadow:
    var(--hub-glow),
    0 0 0 0 color-mix(in srgb, var(--token-color) 55%, transparent); /* reserved for hover aura */
  transition: transform .25s ease, border-radius .35s ease, box-shadow .25s ease, width .35s ease, height .35s ease, background .35s ease;
  animation: drift linear infinite;
  z-index:4;
  /* custom orbit values get set inline by JS */
}
.token:hover{
  box-shadow:
    var(--hub-glow-strong),
    0 0 18px 4px color-mix(in srgb, var(--token-color) 65%, transparent);
  transform: translateZ(0) scale(1.045);
}
.token:focus-visible{
  outline:none;
  box-shadow:
    var(--hub-glow-strong),
    0 0 0 4px color-mix(in srgb, var(--token-color) 48%, transparent),
    0 0 18px 6px color-mix(in srgb, var(--token-color) 62%, transparent);
}

.token[data-pillar="divine"]{ --token-color: var(--token-divine); }
.token[data-pillar="family"]{ --token-color: var(--token-family); }
.token[data-pillar="self"]{ --token-color: var(--token-self); }
.token[data-pillar="rrr"]{ --token-color: var(--token-rrr); }
.token[data-pillar="work"]{ --token-color: var(--token-work); }

/* morph into ARCH DOOR on click (with wood slats + aura) */
.token.door{
  --size: 120px;
  width:150px; height:190px;
  border-radius: 90px 90px 14px 14px; /* arch */
  background:
    radial-gradient(circle at 38% 12%, color-mix(in srgb, var(--surface-strong) 92%, transparent) 0 40%, transparent 68%),
    repeating-linear-gradient(90deg,
      color-mix(in srgb, var(--surface) 18%, transparent) 0 7px,
      color-mix(in srgb, var(--ink) 10%, transparent) 7px 9px),
    linear-gradient(165deg,
      color-mix(in srgb, var(--token-color) 86%, var(--surface) 14%),
      color-mix(in srgb, var(--token-color) 72%, var(--ink) 22%));
  box-shadow:
    0 10px 26px rgba(var(--hub-shadow-rgb),0.20),
    0 0 0 1px rgba(var(--hub-shadow-rgb),0.10) inset,
    0 0 24px 8px color-mix(in srgb, var(--token-color) 60%, transparent);
  animation-play-state: paused; /* stop drifting when it becomes a door */
  position: relative;
  outline: 2px solid color-mix(in srgb, var(--token-color) 30%, transparent);
  outline-offset: 0;
  transition: box-shadow .3s ease, transform .25s ease;
}

/* tiny knob */
.token.door::after{
  content:"";
  position:absolute; right:18px; top:54%;
  width:12px; height:12px; border-radius:50%;
  background:color-mix(in srgb, var(--ink) 70%, transparent);
  transform: translateY(-50%);
  box-shadow:
    0 0 0 1px color-mix(in srgb, var(--surface) 72%, transparent) inset,
    0 2px 4px color-mix(in srgb, var(--ink) 26%, transparent);
}

/* star glimmer that pulses on active door */
.token.door::before{
  content:"";
  position:absolute; left:16%; top:20%;
  width:10px; height:10px;
  background:
    radial-gradient(circle, color-mix(in srgb, var(--surface-strong) 100%, transparent) 0 40%, transparent 41%),
    radial-gradient(circle at 50% 50%, color-mix(in srgb, var(--surface) 92%, transparent), transparent 55%);
  border-radius:50%;
  filter: drop-shadow(0 0 10px color-mix(in srgb, var(--token-color) 70%, transparent));
  animation: door-glimmer 3.6s ease-in-out infinite;
  opacity:0;
}
@keyframes door-glimmer{
  0%,35%{ transform: scale(.2); opacity:0; }
  36%,45%{ transform: scale(1);  opacity:.9; }
  55%,100%{ transform: scale(.2); opacity:0; }
}

/* orbit motion */
@keyframes drift{
  from { transform: rotate(var(--angle, 0deg)) translate(var(--radius, 160px)) rotate(calc(var(--angle, 0deg) * -1)); }
  to   { transform: rotate(calc(var(--angle, 0deg) + 360deg)) translate(var(--radius, 160px)) rotate(calc(var(--angle, 0deg) * -1 - 360deg)); }
}

/* ~lines 222-260: modes + a11y */
body.mode-structured .token{
  animation-play-state: paused;
  /* snap into a quiet ring when Structured mode is on */
  transform: rotate(var(--angle,0deg)) translate(210px) rotate(calc(var(--angle,0deg) * -1));
  transition: transform .45s ease;
}
body.mode-structured #pond{ place-items: center; }
body.mode-structured #dropCrumb{ display:none; }

.sparkles{
  position:absolute; inset:0; pointer-events:none;
  background-image:
    radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,0.9), transparent 65%),
    radial-gradient(1.5px 1.5px at 72% 40%, rgba(255,255,255,0.9), transparent 65%),
    radial-gradient(1.7px 1.7px at 34% 70%, rgba(255,255,255,0.9), transparent 65%),
    radial-gradient(1.8px 1.8px at 60% 78%, rgba(255,255,255,0.9), transparent 65%);
  animation: twinkle 8s ease-in-out infinite;
  opacity:0.55;
}
@keyframes twinkle{ 0%,100%{ opacity:0.25 } 50%{ opacity:0.7 } }

/* reduced motion kindness */
@media (prefers-reduced-motion: reduce){
  #pond::before, .swirl, .token, .sparkles{ animation: none !important; }
}
