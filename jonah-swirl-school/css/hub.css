/* ================================
   Swirlface Dev Lab â€” Styles
   Palette = art-pastels (not baby)
   ================================ */

/* ~lines 6-38: base + palette */
:root{
  --hub-shadow-rgb: 27,31,51;
  --hub-glow: 0 12px 28px rgba(var(--hub-shadow-rgb),0.14);
  --hub-glow-strong: 0 22px 52px rgba(var(--hub-shadow-rgb),0.18);
  --hub-veil: color-mix(in srgb, var(--surface) 88%, transparent);
  --hub-ring: color-mix(in srgb, var(--cup-mint) 26%, transparent);
  --hub-wash-peach: color-mix(in oklab, var(--glow-apricot) 82%, transparent);
  --hub-wash-sky: color-mix(in oklab, var(--glow-sky) 84%, transparent);
  --hub-wash-pink: color-mix(in oklab, var(--glow-rose) 80%, transparent);
  --hub-wash-butter: color-mix(in oklab, var(--glow-apricot) 74%, transparent);
}

* { box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  color:var(--ink);
  font: 16px/1.45 ui-sans-serif, system-ui, -apple-system, Segoe UI, Inter, Roboto, Arial, sans-serif;
  background:
    radial-gradient(1400px 960px at 10% 0%, color-mix(in srgb, var(--hub-wash-peach) 72%, transparent) 0 48%, transparent 80%),
    radial-gradient(1100px 880px at 90% 8%, color-mix(in srgb, var(--hub-wash-pink) 64%, transparent) 0 44%, transparent 78%),
    radial-gradient(1180px 900px at 50% 88%, color-mix(in srgb, var(--hub-wash-sky) 58%, transparent) 0 46%, transparent 82%),
    var(--paper);
  background-attachment: fixed;
}

/* ~lines 40-78: toolbar */
.lab-toolbar{
  position:fixed;
  top:clamp(12px, 3vw, 26px);
  left:50%;
  transform:translateX(-50%);
  width:min(760px, calc(100% - clamp(32px, 10vw, 88px)));
  display:flex;
  align-items:center;
  gap:clamp(10px, 3vw, 20px);
  padding:10px clamp(14px, 3vw, 20px);
  background:var(--hub-veil);
  backdrop-filter: blur(16px);
  border-radius:18px;
  border:1px solid var(--hub-ring);
  box-shadow: 0 20px 40px -28px rgba(var(--hub-shadow-rgb),0.24);
  z-index:12;
  flex-wrap:wrap;
}
.brand{
  display:flex;
  align-items:center;
  gap:10px;
  font-size:1rem;
  font-weight:600;
  letter-spacing:0.3px;
  color:color-mix(in srgb, var(--ink-soft) 92%, transparent);
}
.swirl-dot{
  width:16px;
  height:16px;
  border-radius:50%;
  background:conic-gradient(from 0deg,
    var(--glow-sky),
    var(--glow-apricot),
    var(--glow-rose),
    var(--accent1),
    var(--glow-sky)
  );
  box-shadow:0 0 0 1px color-mix(in srgb, var(--accent1) 28%, transparent) inset;
}
.pill{
  appearance:none;
  border:1px solid transparent;
  border-radius:999px;
  padding:8px 16px;
  background:color-mix(in srgb, var(--surface) 94%, transparent);
  box-shadow:0 6px 18px -14px rgba(var(--hub-shadow-rgb),0.3);
  cursor:pointer;
  color:var(--ink);
  font-size:0.95rem;
  transition: background .2s ease, box-shadow .2s ease, border-color .2s ease;
}
.pill:hover{
  background:color-mix(in srgb, var(--surface-strong) 96%, transparent);
}
.pill:focus-visible{
  outline:3px solid color-mix(in srgb, var(--accent1) 60%, transparent);
  outline-offset:2px;
}
#crumbBox{
  flex:1 1 clamp(240px, 44vw, 420px);
  min-width:clamp(220px, 42vw, 320px);
  background:color-mix(in srgb, var(--surface-strong) 96%, transparent);
  border:1.5px solid color-mix(in srgb, var(--accent1) 26%, transparent);
  cursor:text;
  transition: border-color .2s ease, box-shadow .2s ease, background .2s ease;
}
#crumbBox.crumb-input{
  padding:10px 18px;
}
#crumbBox::placeholder{
  color:color-mix(in srgb, var(--ink) 56%, transparent);
}
#crumbBox:focus-visible{
  outline:none;
  border-color:color-mix(in srgb, var(--accent1) 44%, transparent);
  box-shadow:0 0 0 3px color-mix(in srgb, var(--accent1) 30%, transparent);
}
#crumbBox.quick-saved{
  background:color-mix(in srgb, var(--accent1) 14%, var(--surface-strong));
}
#crumbBox.is-pulsing{
  animation: crumb-pulse 1s ease;
}
@keyframes crumb-pulse{
  0%{ box-shadow:0 0 0 0 color-mix(in srgb, var(--accent1) 34%, transparent); }
  60%{ box-shadow:0 0 0 12px transparent; }
  100%{ box-shadow:0 0 0 0 transparent; }
}

.view-toggle{
  display:flex;
  align-items:center;
  gap:10px;
  flex:0 0 auto;
}

.view-toggle__legend{
  font-size:0.82rem;
  letter-spacing:0.4px;
  text-transform:uppercase;
  color:color-mix(in srgb, var(--ink-soft) 78%, transparent);
}

.mode-switch{
  --switch-track: 50px;
  --switch-height: 26px;
  display:grid;
  grid-template-columns:auto var(--switch-track) auto;
  align-items:center;
  gap:10px;
  padding:6px 14px;
  border-radius:999px;
  border:1.5px solid color-mix(in srgb, var(--accent1) 34%, transparent);
  background:color-mix(in srgb, var(--surface) 92%, transparent);
  box-shadow:0 8px 22px -16px rgba(var(--hub-shadow-rgb),0.32);
  cursor:pointer;
  color:color-mix(in srgb, var(--ink-soft) 90%, transparent);
  font-size:0.85rem;
  font-weight:600;
  transition: background .2s ease, border-color .2s ease, box-shadow .2s ease;
}

.mode-switch:hover{
  background:color-mix(in srgb, var(--surface-strong) 94%, transparent);
  box-shadow:0 12px 26px -18px rgba(var(--hub-shadow-rgb),0.34);
}

.mode-switch:focus-visible{
  outline:3px solid color-mix(in srgb, var(--accent1) 48%, transparent);
  outline-offset:2px;
}

.mode-switch__track{
  position:relative;
  width:var(--switch-track);
  height:var(--switch-height);
  border-radius:999px;
  background:color-mix(in srgb, var(--accent1) 26%, var(--surface));
  box-shadow:inset 0 0 0 1px color-mix(in srgb, var(--accent1) 40%, transparent);
  transition: background .25s ease;
}

.mode-switch__thumb{
  position:absolute;
  top:50%;
  left:4px;
  width:18px;
  height:18px;
  border-radius:50%;
  background:color-mix(in srgb, var(--surface-strong) 98%, transparent);
  box-shadow:0 6px 16px -6px rgba(var(--hub-shadow-rgb),0.45);
  transform:translate(0, -50%);
  transition: transform .28s ease, box-shadow .28s ease;
}

.mode-switch__label{
  opacity:.55;
  transition: opacity .2s ease;
}

.mode-switch[aria-checked="true"] .mode-switch__label--swirl,
.mode-switch[aria-checked="false"] .mode-switch__label--structure{
  opacity:1;
}

.mode-switch[aria-checked="false"] .mode-switch__track{
  background:color-mix(in srgb, var(--accent2) 32%, var(--surface));
  box-shadow:inset 0 0 0 1px color-mix(in srgb, var(--accent2) 40%, transparent);
}

.mode-switch[aria-checked="false"] .mode-switch__thumb{
  transform:translate(calc(var(--switch-track) - 22px), -50%);
}

@media (max-width: 640px){
  .lab-toolbar{
    width:min(94vw, 540px);
    gap:14px;
    padding:10px 14px;
  }
  .view-toggle{
    width:100%;
    justify-content:center;
  }
  #crumbBox{
    flex-basis:100%;
    min-width:100%;
  }
  #pond{
    padding-top: clamp(220px, 54vh, 340px);
    padding-bottom: clamp(220px, 52vh, 340px);
  }
  .site-banner{
    top:clamp(150px, 36vh, 240px);
    width:min(400px, calc(100vw - 48px));
    padding:0.5rem 1.2rem 0.85rem;
  }
}

@media (max-width: 420px){
  .lab-toolbar{
    padding:8px 10px;
  }
}

/* ~lines 80-144: pond + swirl + ripples */
#pond{
  position:relative;
  min-height:100dvh;
  width:100%;
  overflow:hidden;
  display:grid;
  place-items:center;
  padding: clamp(200px, 36vh, 300px) clamp(20px, 6vw, 48px) clamp(210px, 44vh, 320px);
}

.site-banner{
  position:absolute;
  top:clamp(108px, 24vh, 188px);
  left:50%;
  transform:translateX(-50%);
  text-align:center;
  width:min(440px, calc(100vw - 72px));
  padding:0.75rem 1.6rem 1.05rem;
  border-radius:20px;
  background:
    linear-gradient(165deg,
      color-mix(in srgb, var(--surface-strong) 96%, transparent) 0%,
      color-mix(in srgb, var(--glow-apricot) 22%, var(--surface-strong)) 100%);
  border:1px solid color-mix(in srgb, var(--accent1) 18%, transparent);
  box-shadow:
    0 20px 46px -32px rgba(var(--hub-shadow-rgb),0.28),
    inset 0 1px 0 color-mix(in srgb, white 35%, transparent);
  backdrop-filter: blur(12px);
  z-index:9;
  pointer-events:none;
}
.site-banner h1{
  margin:0;
  font-size:2.2rem;
  font-weight:700;
  letter-spacing:0.6px;
  color:color-mix(in srgb, var(--ink-soft) 96%, transparent);
}
.site-banner .site-subtitle{
  margin:8px 0 0;
  font-size:1.1rem;
  letter-spacing:0.5px;
  color:color-mix(in srgb, var(--ink-mist) 86%, transparent);
}

/* soft rippling field (a hair stronger so rings read) */
#pond::before{
  content:"";
  position:absolute;
  inset:-22%;
  background:
    radial-gradient(circle at 50% 38%, color-mix(in srgb, var(--glow-apricot) 64%, transparent) 0 34%, transparent 74%),
    radial-gradient(circle at 52% 64%, color-mix(in srgb, var(--glow-sky) 60%, transparent) 0 28%, transparent 52%),
    radial-gradient(circle at 48% 34%, color-mix(in srgb, var(--glow-rose) 58%, transparent) 0 22%, transparent 56%),
    repeating-radial-gradient(circle at 50% 50%,
      color-mix(in srgb, var(--ring-peach) 58%, transparent) 0 2px,
      transparent 2px 16px);
  mix-blend-mode: soft-light;
  animation: ripple 22s ease-in-out infinite;
  pointer-events:none;
}
@keyframes ripple{
  0%,100%{ transform: scale(1); opacity:0.6; }
  50%    { transform: scale(1.05); opacity:0.82; }
}

.swirl{
  position:relative;
  width: clamp(260px, 38vw, 400px);
  aspect-ratio: 1/1;
  border-radius:50%;
  display:grid;
  place-items:center;
  padding: clamp(24px, 4.4vw, 44px);
  background:
    radial-gradient(68% 64% at 50% 34%, color-mix(in srgb, var(--surface-strong) 96%, transparent) 0 58%, transparent 84%),
    radial-gradient(92% 86% at 50% 74%, color-mix(in srgb, var(--glow-apricot) 54%, transparent) 0 72%, transparent 92%);
  box-shadow:
    inset 0 0 30px color-mix(in srgb, var(--glow-apricot) 48%, transparent),
    0 34px 70px -42px rgba(var(--hub-shadow-rgb),0.35),
    var(--hub-glow-strong);
  animation: breathe 7s ease-in-out infinite;
  z-index:7;
  isolation:isolate;
}
.swirl::before{
  content:"";
  position:absolute;
  inset:-42px;
  border-radius:50%;
  background:
    radial-gradient(78% 72% at 48% 32%, color-mix(in srgb, var(--glow-rose) 62%, transparent) 0 56%, transparent 86%),
    radial-gradient(84% 78% at 54% 70%, color-mix(in srgb, var(--glow-sky) 58%, transparent) 0 58%, transparent 88%);
  opacity:0.9;
  filter: blur(34px);
  z-index:-1;
}
.swirl::after{
  content:"";
  position:absolute;
  inset: clamp(30px, 6.4vw, 46px);
  border-radius:50%;
  background:
    radial-gradient(circle at 50% 46%, color-mix(in srgb, var(--surface-strong) 94%, transparent) 0 42%, transparent 72%),
    radial-gradient(circle at 50% 50%, color-mix(in srgb, var(--ring-mint) 48%, transparent) 58%, transparent 86%);
  opacity:0.88;
  z-index:0;
}
@keyframes breathe{
  0%,100%{ transform:scale(1); }
  50%{ transform:scale(1.03); }
}
.swirl-svg{
  width:min(82%, 320px);
  height:auto;
  position:relative;
  display:block;
  filter: drop-shadow(0 12px 24px rgba(var(--hub-shadow-rgb),0.18));
  z-index:1;
}
.enter-day{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  width:clamp(96px, 15vw, 140px);
  height:clamp(96px, 15vw, 140px);
  border-radius:50%;
  border:0;
  display:block;
  background:transparent;
  cursor:pointer;
  z-index:8;
}
.enter-day::after{
  content:"";
  position:absolute;
  inset:-18px;
  border-radius:inherit;
  border:2px solid transparent;
  box-shadow:0 0 0 0 transparent;
  transition: border-color .25s ease, box-shadow .25s ease;
}
.enter-day:hover::after{
  box-shadow:0 0 0 12px color-mix(in srgb, var(--accent1) 16%, transparent);
}
.enter-day:focus-visible{
  outline:none;
}
.enter-day:focus-visible::after{
  border-color:color-mix(in srgb, var(--accent1) 70%, transparent);
  box-shadow:0 0 0 6px color-mix(in srgb, var(--accent1) 32%, transparent);
}

/* ~lines 146-220: tokens (circles â†’ doors) */
.token{
  --size: clamp(78px, 11vw, 102px);
  --token-color: var(--token-self);
  --orbit-duration: 36s;
  --pulse-duration: 7.5s;
  --pulse-delay: 0s;
  position:absolute;
  inset:auto;
  width:var(--size);
  height:var(--size);
  border-radius:50%;
  border:none;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:0 10px;
  color:color-mix(in srgb, var(--ink) 90%, transparent);
  font-weight:600;
  font-size:0.92rem;
  letter-spacing:0.18px;
  background:
    radial-gradient(circle at 32% 26%, color-mix(in srgb, var(--surface-strong) 92%, transparent) 0 48%, transparent 72%),
    linear-gradient(160deg,
      color-mix(in srgb, var(--token-color) 86%, var(--surface) 14%),
      color-mix(in srgb, var(--token-color) 74%, var(--accent1) 26%));
  box-shadow:0 16px 36px -28px rgba(var(--hub-shadow-rgb),0.32);
  filter:saturate(1);
  transition: transform .25s ease, box-shadow .25s ease, background .3s ease, filter .3s ease;
  animation: drift var(--orbit-duration) linear infinite;
  z-index:5;
  isolation:isolate;
  /* custom orbit values get set inline by JS */
}

.token::after{
  content:"";
  position:absolute;
  inset:-16px;
  border-radius:inherit;
  background:radial-gradient(circle at 50% 50%, color-mix(in srgb, var(--token-color) 64%, transparent) 0 56%, transparent 76%);
  opacity:0;
  filter: blur(0.5px);
  transform: scale(0.86);
  pointer-events:none;
  z-index:-1;
  animation: token-glow var(--pulse-duration) ease-in-out infinite;
  animation-delay: var(--pulse-delay);
}
.token:hover{
  box-shadow:
    0 22px 48px -28px rgba(var(--hub-shadow-rgb),0.34),
    0 0 18px 6px color-mix(in srgb, var(--token-color) 62%, transparent);
  transform: translateZ(0) scale(1.05);
  filter:saturate(1.05);
}
.token:focus-visible{
  outline:none;
  box-shadow:
    0 22px 48px -28px rgba(var(--hub-shadow-rgb),0.34),
    0 0 0 4px color-mix(in srgb, var(--token-color) 48%, transparent),
    0 0 18px 6px color-mix(in srgb, var(--token-color) 62%, transparent);
  filter:saturate(1.05);
}

.token[data-pillar="divine"]{ --token-color: var(--token-divine); }
.token[data-pillar="family"]{ --token-color: var(--token-family); }
.token[data-pillar="self"]{ --token-color: var(--token-self); }
.token[data-pillar="rrr"]{ --token-color: var(--token-rrr); }
.token[data-pillar="work"]{ --token-color: var(--token-work); }

/* morph into ARCH DOOR on click (with wood slats + aura) */
.token.door{
  --size: 120px;
  width:150px; height:190px;
  border-radius: 90px 90px 14px 14px; /* arch */
  background:
    radial-gradient(circle at 38% 12%, color-mix(in srgb, var(--surface-strong) 92%, transparent) 0 40%, transparent 68%),
    repeating-linear-gradient(90deg,
      color-mix(in srgb, var(--surface) 18%, transparent) 0 7px,
      color-mix(in srgb, var(--ink) 10%, transparent) 7px 9px),
    linear-gradient(165deg,
      color-mix(in srgb, var(--token-color) 86%, var(--surface) 14%),
      color-mix(in srgb, var(--token-color) 72%, var(--ink) 22%));
  box-shadow:
    0 10px 26px rgba(var(--hub-shadow-rgb),0.20),
    0 0 0 1px rgba(var(--hub-shadow-rgb),0.10) inset,
    0 0 24px 8px color-mix(in srgb, var(--token-color) 60%, transparent);
  animation-play-state: paused; /* stop drifting when it becomes a door */
  position: relative;
  outline: 2px solid color-mix(in srgb, var(--token-color) 30%, transparent);
  outline-offset: 0;
  transition: box-shadow .3s ease, transform .25s ease;
}

/* tiny knob */
.token.door::after{
  content:"";
  position:absolute; right:18px; top:54%;
  width:12px; height:12px; border-radius:50%;
  background:color-mix(in srgb, var(--ink) 70%, transparent);
  transform: translateY(-50%);
  box-shadow:
    0 0 0 1px color-mix(in srgb, var(--surface) 72%, transparent) inset,
    0 2px 4px color-mix(in srgb, var(--ink) 26%, transparent);
}

/* star glimmer that pulses on active door */
.token.door::before{
  content:"";
  position:absolute; left:16%; top:20%;
  width:10px; height:10px;
  background:
    radial-gradient(circle, color-mix(in srgb, var(--surface-strong) 100%, transparent) 0 40%, transparent 41%),
    radial-gradient(circle at 50% 50%, color-mix(in srgb, var(--surface) 92%, transparent), transparent 55%);
  border-radius:50%;
  filter: drop-shadow(0 0 10px color-mix(in srgb, var(--token-color) 70%, transparent));
  animation: door-glimmer 3.6s ease-in-out infinite;
  opacity:0;
}
@keyframes door-glimmer{
  0%,35%{ transform: scale(.2); opacity:0; }
  36%,45%{ transform: scale(1);  opacity:.9; }
  55%,100%{ transform: scale(.2); opacity:0; }
}

/* glow + orbit motion */
@keyframes token-glow{
  0%,100%{
    opacity:0;
    transform: scale(0.8);
    filter: blur(0.5px);
  }
  42%{
    opacity:0.56;
    transform: scale(1.12);
    filter: blur(6px);
  }
  60%{
    opacity:0.2;
    transform: scale(1.02);
    filter: blur(2.5px);
  }
}

/* orbit motion */
@keyframes drift{
  from { transform: rotate(var(--angle, 0deg)) translate(var(--radius, 160px)) rotate(calc(var(--angle, 0deg) * -1)); }
  to   { transform: rotate(calc(var(--angle, 0deg) + 360deg)) translate(var(--radius, 160px)) rotate(calc(var(--angle, 0deg) * -1 - 360deg)); }
}

/* ~lines 222-260: modes + a11y */
body:not(.mode-swirl) .token{
  animation-play-state: paused;
  /* snap into a quiet ring when Structured mode is on */
  transform: rotate(var(--angle,0deg)) translate(210px) rotate(calc(var(--angle,0deg) * -1));
  transition: transform .45s ease;
}
body:not(.mode-swirl) .token::after{
  animation-play-state: running;
}
body:not(.mode-swirl) #pond{ place-items: center; }

.sparkles{
  position:absolute; inset:0; pointer-events:none;
  background-image:
    radial-gradient(2px 2px at 20% 30%, color-mix(in srgb, var(--surface-strong) 96%, transparent), transparent 65%),
    radial-gradient(1.5px 1.5px at 72% 40%, color-mix(in srgb, var(--surface-strong) 96%, transparent), transparent 65%),
    radial-gradient(1.7px 1.7px at 34% 70%, color-mix(in srgb, var(--surface-strong) 96%, transparent), transparent 65%),
    radial-gradient(1.8px 1.8px at 60% 78%, color-mix(in srgb, var(--surface-strong) 96%, transparent), transparent 65%);
  animation: twinkle 8s ease-in-out infinite;
  opacity:0.55;
}
@keyframes twinkle{ 0%,100%{ opacity:0.25 } 50%{ opacity:0.7 } }

/* reduced motion kindness */
@media (prefers-reduced-motion: reduce){
  #pond::before, .swirl, .token, .token::after, .sparkles{ animation: none !important; }
}
