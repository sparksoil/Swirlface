/* ================================
   Swirlface Dev Lab — Styles
   Palette = art-pastels (not baby)
   ================================ */

/* ~lines 6-38: base + palette */
:root{
  --hub-shadow-rgb: 27,31,51;
  --hub-glow: 0 12px 26px rgba(var(--hub-shadow-rgb),0.12), 0 0 0 1px rgba(var(--hub-shadow-rgb),0.06);
  --hub-glow-strong: 0 18px 42px rgba(var(--hub-shadow-rgb),0.18), 0 0 0 1px rgba(var(--hub-shadow-rgb),0.08);
  --hub-veil: color-mix(in srgb, var(--surface) 72%, transparent);
  --hub-ring: color-mix(in srgb, var(--ink) 12%, transparent);
  --hub-bg-peach: color-mix(in srgb, var(--pastel-peach) 68%, transparent);
  --hub-bg-sky: color-mix(in srgb, var(--pastel-sky) 70%, transparent);
  --hub-bg-pink: color-mix(in srgb, var(--pastel-pink) 60%, transparent);
  --hub-bg-mint: color-mix(in srgb, var(--accent1) 65%, transparent);
}

* { box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  color:var(--ink);
  font: 16px/1.45 ui-sans-serif, system-ui, -apple-system, Segoe UI, Inter, Roboto, Arial, sans-serif;
  background:
    radial-gradient(1200px 840px at 18% 0%, var(--hub-bg-peach), transparent 64%),
    radial-gradient(1020px 900px at 85% 12%, var(--hub-bg-sky), transparent 60%),
    radial-gradient(1100px 940px at 12% 90%, var(--hub-bg-pink), transparent 58%),
    radial-gradient(960px 880px at 88% 88%, var(--hub-bg-mint), transparent 60%),
    var(--paper);
  background-attachment: fixed;
}

/* ~lines 40-78: toolbar */
.lab-toolbar{
  position:fixed; inset: 16px 16px auto 16px;
  display:flex; align-items:center; justify-content:space-between;
  gap:16px; padding:10px 12px;
  background:var(--hub-veil);
  backdrop-filter: blur(8px);
  border-radius:14px; box-shadow: var(--hub-glow);
  border:1px solid var(--hub-ring);
  z-index: 10;
}
.brand{ display:flex; align-items:center; gap:10px; }
.swirl-dot{
  width:18px; height:18px; border-radius:50%;
  background:conic-gradient(from 0deg,
    var(--pastel-sky),
    var(--pastel-peach),
    var(--pastel-pink),
    var(--accent1),
    var(--pastel-sky)
  );
  box-shadow: 0 0 0 1px var(--hub-ring) inset;
}
.pill{
  appearance:none; border:0; border-radius:999px; padding:8px 14px;
  background:var(--surface-strong);
  box-shadow: var(--hub-glow);
  cursor:pointer;
  color:var(--ink);
}
.pill.active{
  background:var(--surface);
  box-shadow: var(--hub-glow-strong);
}
.modes{ display:flex; gap:8px; }
#crumbBox{ flex:1; min-width:160px; }

/* ~lines 80-144: pond + swirl + ripples */
#pond{
  position:relative;
  min-height:100dvh;
  width:100%;
  overflow:hidden;
  display:grid;
  place-items:center;
  padding: clamp(140px, 24vh, 220px) 0;
}

.site-banner{
  position:absolute;
  top:clamp(88px, 18vh, 160px);
  left:50%; transform:translateX(-50%);
  text-align:center;
  z-index:6; pointer-events:none;
}
.site-banner h1{
  margin:0; font-size:2.1rem; font-weight:700;
  background:linear-gradient(90deg,
    color-mix(in srgb, var(--accent2) 70%, var(--pastel-pink) 30%),
    color-mix(in srgb, var(--pastel-peach) 60%, var(--accent3) 40%),
    color-mix(in srgb, var(--pastel-sky) 60%, var(--accent1) 40%)
  );
  -webkit-background-clip:text; color:transparent;
}
.site-banner p{
  margin:6px 0 0; font-size:1.15rem; letter-spacing:0.5px;
  color:color-mix(in srgb, var(--ink) 82%, transparent);
}

/* soft rippling field (a hair stronger so rings read) */
#pond::before{
  content:"";
  position:absolute;
  inset:-22%;
  background:
    radial-gradient(circle at 50% 46%, color-mix(in srgb, var(--surface-strong) 88%, transparent) 0 40%, transparent 70%),
    repeating-radial-gradient(circle at 50% 50%,
      color-mix(in srgb, var(--surface) 75%, transparent) 0 2px,
      transparent 2px 12px);
  mix-blend-mode: soft-light;
  animation: ripple 16s ease-in-out infinite;
  pointer-events:none;
}
@keyframes ripple{
  0%,100%{ transform: scale(1); opacity:0.6; }
  50%    { transform: scale(1.06); opacity:0.8; }
}

.swirl{
  position:relative;
  width: clamp(230px, 34vw, 360px);
  aspect-ratio: 1/1;
  border-radius:50%;
  display:grid;
  place-items:center;
  padding: clamp(14px, 3vw, 28px);
  background: radial-gradient(68% 64% at 50% 38%, color-mix(in srgb, var(--surface-strong) 92%, transparent) 0 48%, transparent 76%);
  box-shadow: var(--hub-glow-strong);
  animation: breathe 6.5s ease-in-out infinite;
  z-index:5;
}
.swirl::before{
  content:"";
  position:absolute;
  inset:-28px;
  border-radius:50%;
  background:
    radial-gradient(75% 75% at 50% 50%, color-mix(in srgb, var(--hub-bg-mint) 55%, transparent) 0 52%, transparent 90%),
    radial-gradient(88% 88% at 50% 30%, color-mix(in srgb, var(--hub-bg-peach) 55%, transparent) 0 35%, transparent 75%);
  opacity:0.8;
  filter: blur(2px);
  z-index:-1;
}
@keyframes breathe{ 0%,100%{ transform:scale(1)} 50%{ transform:scale(1.03)} }
.swirl-svg{
  width:82%;
  height:82%;
  position:relative;
  z-index:1;
}
.enter-day{
  position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
  width:96px; height:138px; border-radius:60px 60px 12px 12px;
  background: radial-gradient(60% 50% at 50% 38%, color-mix(in srgb, var(--accent1) 42%, transparent) 0 60%, transparent 92%);
  box-shadow: 0 0 0 1px color-mix(in srgb, var(--accent1) 32%, transparent), 0 24px 42px -28px color-mix(in srgb, var(--accent1) 60%, transparent);
  border:0;
  display:block;
  z-index:6;
  pointer-events:auto;
}
.enter-day:focus-visible{
  outline:3px solid color-mix(in srgb, var(--accent1) 60%, transparent);
  outline-offset:8px;
}

/* ~lines 146-220: tokens (circles → doors) */
.token{
  --size: 88px;
  --token-color: var(--token-self);
  position:absolute; inset:auto;
  width:var(--size); height:var(--size); border-radius:50%;
  border:none; cursor:pointer;
  display:flex; align-items:center; justify-content:center;
  text-align:center; padding:0 8px;
  color:color-mix(in srgb, var(--ink) 88%, transparent);
  font-weight:600; letter-spacing:0.2px;
  background:
    radial-gradient(circle at 35% 28%, color-mix(in srgb, var(--surface-strong) 85%, transparent) 0 45%, transparent 70%),
    linear-gradient(145deg,
      color-mix(in srgb, var(--token-color) 88%, var(--surface) 12%),
      color-mix(in srgb, var(--token-color) 82%, var(--ink) 18%));
  box-shadow:
    var(--hub-glow),
    0 0 0 0 color-mix(in srgb, var(--token-color) 55%, transparent); /* reserved for hover aura */
  transition: transform .25s ease, border-radius .35s ease, box-shadow .25s ease, width .35s ease, height .35s ease, background .35s ease;
  animation: drift linear infinite;
  z-index:4;
  /* custom orbit values get set inline by JS */
}
.token:hover{
  box-shadow:
    var(--hub-glow-strong),
    0 0 18px 4px color-mix(in srgb, var(--token-color) 65%, transparent);
  transform: translateZ(0) scale(1.045);
}
.token:focus-visible{
  outline:none;
  box-shadow:
    var(--hub-glow-strong),
    0 0 0 4px color-mix(in srgb, var(--token-color) 48%, transparent),
    0 0 18px 6px color-mix(in srgb, var(--token-color) 62%, transparent);
}

.token[data-pillar="divine"]{ --token-color: var(--token-divine); }
.token[data-pillar="family"]{ --token-color: var(--token-family); }
.token[data-pillar="self"]{ --token-color: var(--token-self); }
.token[data-pillar="rrr"]{ --token-color: var(--token-rrr); }
.token[data-pillar="work"]{ --token-color: var(--token-work); }

/* morph into ARCH DOOR on click (with wood slats + aura) */
.token.door{
  --size: 120px;
  width:150px; height:190px;
  border-radius: 90px 90px 14px 14px; /* arch */
  background:
    radial-gradient(circle at 38% 12%, color-mix(in srgb, var(--surface-strong) 92%, transparent) 0 40%, transparent 68%),
    repeating-linear-gradient(90deg,
      color-mix(in srgb, var(--surface) 18%, transparent) 0 7px,
      color-mix(in srgb, var(--ink) 10%, transparent) 7px 9px),
    linear-gradient(165deg,
      color-mix(in srgb, var(--token-color) 86%, var(--surface) 14%),
      color-mix(in srgb, var(--token-color) 72%, var(--ink) 22%));
  box-shadow:
    0 10px 26px rgba(var(--hub-shadow-rgb),0.20),
    0 0 0 1px rgba(var(--hub-shadow-rgb),0.10) inset,
    0 0 24px 8px color-mix(in srgb, var(--token-color) 60%, transparent);
  animation-play-state: paused; /* stop drifting when it becomes a door */
  position: relative;
  outline: 2px solid color-mix(in srgb, var(--token-color) 30%, transparent);
  outline-offset: 0;
  transition: box-shadow .3s ease, transform .25s ease;
}

/* tiny knob */
.token.door::after{
  content:"";
  position:absolute; right:18px; top:54%;
  width:12px; height:12px; border-radius:50%;
  background:color-mix(in srgb, var(--ink) 70%, transparent);
  transform: translateY(-50%);
  box-shadow:
    0 0 0 1px color-mix(in srgb, var(--surface) 72%, transparent) inset,
    0 2px 4px color-mix(in srgb, var(--ink) 26%, transparent);
}

/* star glimmer that pulses on active door */
.token.door::before{
  content:"";
  position:absolute; left:16%; top:20%;
  width:10px; height:10px;
  background:
    radial-gradient(circle, color-mix(in srgb, var(--surface-strong) 100%, transparent) 0 40%, transparent 41%),
    radial-gradient(circle at 50% 50%, color-mix(in srgb, var(--surface) 92%, transparent), transparent 55%);
  border-radius:50%;
  filter: drop-shadow(0 0 10px color-mix(in srgb, var(--token-color) 70%, transparent));
  animation: door-glimmer 3.6s ease-in-out infinite;
  opacity:0;
}
@keyframes door-glimmer{
  0%,35%{ transform: scale(.2); opacity:0; }
  36%,45%{ transform: scale(1);  opacity:.9; }
  55%,100%{ transform: scale(.2); opacity:0; }
}

/* orbit motion */
@keyframes drift{
  from { transform: rotate(var(--angle, 0deg)) translate(var(--radius, 160px)) rotate(calc(var(--angle, 0deg) * -1)); }
  to   { transform: rotate(calc(var(--angle, 0deg) + 360deg)) translate(var(--radius, 160px)) rotate(calc(var(--angle, 0deg) * -1 - 360deg)); }
}

/* ~lines 222-260: modes + a11y */
body.mode-structured .token{
  animation-play-state: paused;
  /* snap into a quiet ring when Structured mode is on */
  transform: rotate(var(--angle,0deg)) translate(210px) rotate(calc(var(--angle,0deg) * -1));
  transition: transform .45s ease;
}
body.mode-structured #pond{ place-items: center; }
body.mode-structured #dropCrumb{ display:none; }

.sparkles{
  position:absolute; inset:0; pointer-events:none;
  background-image:
    radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,0.9), transparent 65%),
    radial-gradient(1.5px 1.5px at 72% 40%, rgba(255,255,255,0.9), transparent 65%),
    radial-gradient(1.7px 1.7px at 34% 70%, rgba(255,255,255,0.9), transparent 65%),
    radial-gradient(1.8px 1.8px at 60% 78%, rgba(255,255,255,0.9), transparent 65%);
  animation: twinkle 8s ease-in-out infinite;
  opacity:0.55;
}
@keyframes twinkle{ 0%,100%{ opacity:0.25 } 50%{ opacity:0.7 } }

/* reduced motion kindness */
@media (prefers-reduced-motion: reduce){
  #pond::before, .swirl, .token, .sparkles{ animation: none !important; }
}
