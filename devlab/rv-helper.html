<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>RV Helper â€” Section E2 (Garden Map)</title>
  <link rel="stylesheet" href="./rv.css">
</head>
<body>
  <header class="poster">
    <h1>ðŸŒ± RV Helper â€” Swirly Logbook</h1>
    <p class="subtitle">Section E2: Garden Map (Constellation)</p>
  </header>

  <main class="wrap">
    <section class="entry-panel">
      <label class="field">
        <span class="label">Person (optional)</span>
        <input id="personInput" type="text" placeholder="e.g., Sarah H.">
      </label>

      <label class="field">
        <span class="label">Notes</span>
        <textarea id="noteInput" rows="6" placeholder="Drop crumbs hereâ€¦"></textarea>
      </label>

      <div class="actions">
        <button id="saveBtn" class="primary">Save Entry</button>
        <button id="sprinkleBtn" class="ghost">Sprinkle âœ¨</button>
        <button id="exportBtn" class="ghost">Export (.rvpack.json)</button>
        <label class="import ghost">
          Import
          <input id="importFile" type="file" accept=".json,.rvpack.json">
        </label>
      </div>
      <p class="micro safety">Local-first save is automatic. Export/import keeps your garden safe.</p>
    </section>

    <section class="list-panel" id="listPanel">
      <div class="list-head">
        <h2>Latest entries</h2>
        <div class="filters">
          <button data-filter="all" class="chip is-active">View all seeds</button>
          <button data-filter="needs" class="chip">Needs water</button>
          <button data-filter="person" class="chip">By personâ€¦</button>
        </div>
      </div>
      <ul id="entriesList" class="entries"></ul>
    </section>
  </main>

  <!-- People surfaces -->
  <section class="people-zone">
    <div class="view-switch">
      <span class="label">View:</span>
      <button id="btnViewList" class="chip is-active">List</button>
      <button id="btnViewCards" class="chip">Cards</button>
      <button id="btnViewMap" class="chip">Map</button>
    </div>

    <!-- Circles (fallback view) -->
    <h2>People as Circles</h2>
    <div id="peopleCircles" class="circles"></div>

    <!-- Cards grid -->
    <div id="cardsGrid" class="cards-grid hidden"></div>

    <!-- Garden map -->
    <div id="mapArea" class="map-area hidden">
      <canvas id="mapCanvas"></canvas>
    </div>
  </section>

  <div id="personDetail" class="person-detail hidden" aria-modal="true" role="dialog">
    <div class="panel-content">
      <button id="closeDetail" class="ghost close-x" aria-label="Close">Ã—</button>
      <h3 id="detailName">Name</h3>
      <div class="stage-row">
        <span id="detailStage" class="stage-badge">Stage 0</span>
        <span id="detailLastTouch" class="last-touch">â€”</span>
      </div>
      <div class="grow-controls">
        <button id="btnVisit" class="primary">Visit (+1)</button>
        <label class="care-pair">
          <input id="chkCare" type="checkbox">
          <span>Care (left note / text / call)</span>
        </label>
        <button id="btnAttempt" class="ghost">Attempt (NAH)</button>
        <button id="btnCareOnly" class="ghost">Care only (+0.5)</button>
      </div>
      <hr class="soft">
      <div id="detailEntries"></div>
    </div>
  </div>

  <footer class="footer">
    <button id="devClearBtn" class="danger">Clear Dev Lab Data</button>
    <small>Section E2 active â€” Garden Map view is live.</small>
  </footer>

  <script src="./verses.js?v=rv-3"></script>
  <script src="./rv.js?v=rv-3"></script>
  <script>
    setTimeout(function(){
      if(!window.__RV_BOOTED){
        var warn=document.createElement('div');
        warn.style.cssText='position:fixed;left:0;right:0;bottom:0;padding:10px 14px;background:#8b2b2b;color:#fff;font-weight:700;z-index:9999';
        warn.textContent='RV Helper: scripts did not load.';
        document.body.appendChild(warn);
      }
    },400);
  </script>
</body>
</html>
